program test_periodictable
   use precision, only: r64, i64
   use isotopes_module, only: isotopes
   use testify_m, only: testify
   use params, only : lookup_periodic_table

   implicit none

   integer, parameter :: nelements = 83

   ! Testify
   integer :: itest
   integer, parameter :: num_tests = 2*nelements
   type(testify) :: test_array(num_tests), tests_all

   ! Variables for old format periodic table
   integer :: niso
   character(len=3), allocatable :: isotope_element(:)
   real(r64), allocatable :: isotope_mass(:)
   real(r64), allocatable :: isotope_abundance(:)

   ! Other variables
   integer :: i, j
   real(r64), allocatable :: mass_new(:), mass_old(:)
   real(r64), allocatable :: abundance_new(:), abundance_old(:)
   character(len=3) :: cur_element
   type(isotopes) :: iso_data

   
   !Generate periodic table
   call create_old_periodic_table(isotope_element, isotope_mass, isotope_abundance)
   niso = size(isotope_element)

   cur_element = ""
   itest = 0
   do i = 1, niso
      if (cur_element /= isotope_element(i)) then
         if (allocated(mass_new)) then
            call compare()
            ! Clean-up
            deallocate (mass_new, mass_old, abundance_new, abundance_old)
         end if

         cur_element = isotope_element(i)

         ! Look up new element
         iso_data = lookup_periodic_table(isotope_element(i))

         ! Allocate new test arrays
         allocate(mass_new(iso_data%numisotopes), &
                  mass_old(iso_data%numisotopes), & 
                  abundance_new(iso_data%numisotopes), &
                  abundance_old(iso_data%numisotopes))
         do j = 1, iso_data%numisotopes
            mass_new(:) = iso_data%masses(:)
            abundance_new(:) = iso_data%abundances(:)
         end do
         j = 0
      end if
      j = j+1
      mass_old(j) = isotope_mass(i)
      abundance_old(j) = isotope_abundance(i)
   end do
   
   if (allocated(mass_new)) then
      call compare()
      ! Clean-up
      deallocate (mass_new, mass_old, abundance_new, abundance_old)
   end if

   tests_all = testify(test_array)
   call tests_all%report
   
   if(tests_all%get_status() .eqv. .false.) error stop -1

contains

   subroutine compare()
      !! Compare data from old and new tables
      ! IMPORTANT: test requires isotopes to ocur in the same order in both tables
      !
      ! Test if last elements data was correct
      itest = itest + 1
      test_array(itest) = testify("Isotope masses of " // trim(cur_element))
      call test_array(itest)%assert(mass_new, mass_old)

      itest = itest + 1
      test_array(itest) = testify("Isotope abundancees of " // trim(cur_element))
      call test_array(itest)%assert(abundance_new, abundance_old)
   end subroutine compare

   subroutine create_old_periodic_table(element, mass, abundance)
      character(len=3), allocatable, intent(out) :: element(:)
      real(r64), allocatable, intent(out) :: mass(:)
      real(r64), allocatable, intent(out) :: abundance(:)

      allocate (element(287), mass(287), abundance(287))

      ! Fill in isotope data.
      element(1) = "Ag"
      mass(1) = 106.905095_r64
      abundance(1) = 51.84_r64
      element(2) = "Ag"
      mass(2) = 108.904754_r64
      abundance(2) = 48.16_r64
      element(3) = "Al"
      mass(3) = 26.981541_r64
      abundance(3) = 100.0_r64
      element(4) = "Ar"
      mass(4) = 35.967546_r64
      abundance(4) = 0.34_r64
      element(5) = "Ar"
      mass(5) = 37.962732_r64
      abundance(5) = 0.063_r64
      element(6) = "Ar"
      mass(6) = 39.962383_r64
      abundance(6) = 99.6_r64
      element(7) = "As"
      mass(7) = 74.921596_r64
      abundance(7) = 100.0_r64
      element(8) = "Au"
      mass(8) = 196.96656_r64
      abundance(8) = 100.0_r64
      element(9) = "B"
      mass(9) = 10.012938_r64
      abundance(9) = 19.8_r64
      element(10) = "B"
      mass(10) = 11.009305_r64
      abundance(10) = 80.2_r64
      element(11) = "Ba"
      mass(11) = 129.906277_r64
      abundance(11) = 0.11_r64
      element(12) = "Ba"
      mass(12) = 131.905042_r64
      abundance(12) = 0.1_r64
      element(13) = "Ba"
      mass(13) = 133.90449_r64
      abundance(13) = 2.42_r64
      element(14) = "Ba"
      mass(14) = 134.905668_r64
      abundance(14) = 6.59_r64
      element(15) = "Ba"
      mass(15) = 135.904556_r64
      abundance(15) = 7.85_r64
      element(16) = "Ba"
      mass(16) = 136.905816_r64
      abundance(16) = 11.23_r64
      element(17) = "Ba"
      mass(17) = 137.905236_r64
      abundance(17) = 71.7_r64
      element(18) = "Be"
      mass(18) = 9.012183_r64
      abundance(18) = 100.0_r64
      element(19) = "Bi"
      mass(19) = 208.980388_r64
      abundance(19) = 100.0_r64
      element(20) = "Br"
      mass(20) = 78.918336_r64
      abundance(20) = 50.69_r64
      element(21) = "Br"
      mass(21) = 80.91629_r64
      abundance(21) = 49.31_r64
      element(22) = "C"
      mass(22) = 12.0_r64
      abundance(22) = 98.9_r64
      element(23) = "C"
      mass(23) = 13.003355_r64
      abundance(23) = 1.1_r64
      element(24) = "Ca"
      mass(24) = 39.962591_r64
      abundance(24) = 96.95_r64
      element(25) = "Ca"
      mass(25) = 41.958622_r64
      abundance(25) = 0.65_r64
      element(26) = "Ca"
      mass(26) = 42.95877_r64
      abundance(26) = 0.14_r64
      element(27) = "Ca"
      mass(27) = 43.955485_r64
      abundance(27) = 2.086_r64
      element(28) = "Ca"
      mass(28) = 45.953689_r64
      abundance(28) = 0.004_r64
      element(29) = "Ca"
      mass(29) = 47.952532_r64
      abundance(29) = 0.19_r64
      element(30) = "Cd"
      mass(30) = 105.906461_r64
      abundance(30) = 1.25_r64
      element(31) = "Cd"
      mass(31) = 107.904186_r64
      abundance(31) = 0.89_r64
      element(32) = "Cd"
      mass(32) = 109.903007_r64
      abundance(32) = 12.49_r64
      element(33) = "Cd"
      mass(33) = 110.904182_r64
      abundance(33) = 12.8_r64
      element(34) = "Cd"
      mass(34) = 111.902761_r64
      abundance(34) = 24.13_r64
      element(35) = "Cd"
      mass(35) = 112.904401_r64
      abundance(35) = 12.22_r64
      element(36) = "Cd"
      mass(36) = 113.903361_r64
      abundance(36) = 28.73_r64
      element(37) = "Cd"
      mass(37) = 115.904758_r64
      abundance(37) = 7.49_r64
      element(38) = "Ce"
      mass(38) = 135.90714_r64
      abundance(38) = 0.19_r64
      element(39) = "Ce"
      mass(39) = 137.905996_r64
      abundance(39) = 0.25_r64
      element(40) = "Ce"
      mass(40) = 139.905442_r64
      abundance(40) = 88.48_r64
      element(41) = "Ce"
      mass(41) = 141.909249_r64
      abundance(41) = 11.08_r64
      element(42) = "Cl"
      mass(42) = 34.968853_r64
      abundance(42) = 75.77_r64
      element(43) = "Cl"
      mass(43) = 36.965903_r64
      abundance(43) = 24.23_r64
      element(44) = "Co"
      mass(44) = 58.933198_r64
      abundance(44) = 100.0_r64
      element(45) = "Cr"
      mass(45) = 49.946046_r64
      abundance(45) = 4.35_r64
      element(46) = "Cr"
      mass(46) = 51.94051_r64
      abundance(46) = 83.79_r64
      element(47) = "Cr"
      mass(47) = 52.940651_r64
      abundance(47) = 9.5_r64
      element(48) = "Cr"
      mass(48) = 53.938882_r64
      abundance(48) = 2.36_r64
      element(49) = "Cs"
      mass(49) = 132.905433_r64
      abundance(49) = 100.0_r64
      element(50) = "Cu"
      mass(50) = 62.929599_r64
      abundance(50) = 69.17_r64
      element(51) = "Cu"
      mass(51) = 64.927792_r64
      abundance(51) = 30.83_r64
      element(52) = "Dy"
      mass(52) = 155.924287_r64
      abundance(52) = 0.06_r64
      element(53) = "Dy"
      mass(53) = 157.924412_r64
      abundance(53) = 0.1_r64
      element(54) = "Dy"
      mass(54) = 159.925203_r64
      abundance(54) = 2.34_r64
      element(55) = "Dy"
      mass(55) = 160.926939_r64
      abundance(55) = 18.9_r64
      element(56) = "Dy"
      mass(56) = 161.926805_r64
      abundance(56) = 25.5_r64
      element(57) = "Dy"
      mass(57) = 162.928737_r64
      abundance(57) = 24.9_r64
      element(58) = "Dy"
      mass(58) = 163.929183_r64
      abundance(58) = 28.2_r64
      element(59) = "Er"
      mass(59) = 161.928787_r64
      abundance(59) = 0.14_r64
      element(60) = "Er"
      mass(60) = 163.929211_r64
      abundance(60) = 1.61_r64
      element(61) = "Er"
      mass(61) = 165.930305_r64
      abundance(61) = 33.6_r64
      element(62) = "Er"
      mass(62) = 166.932061_r64
      abundance(62) = 22.95_r64
      element(63) = "Er"
      mass(63) = 167.932383_r64
      abundance(63) = 26.8_r64
      element(64) = "Er"
      mass(64) = 169.935476_r64
      abundance(64) = 14.9_r64
      element(65) = "Eu"
      mass(65) = 150.91986_r64
      abundance(65) = 47.8_r64
      element(66) = "Eu"
      mass(66) = 152.921243_r64
      abundance(66) = 52.2_r64
      element(67) = "F"
      mass(67) = 18.998403_r64
      abundance(67) = 100.0_r64
      element(68) = "Fe"
      mass(68) = 53.939612_r64
      abundance(68) = 5.8_r64
      element(69) = "Fe"
      mass(69) = 55.934939_r64
      abundance(69) = 91.72_r64
      element(70) = "Fe"
      mass(70) = 56.935396_r64
      abundance(70) = 2.2_r64
      element(71) = "Fe"
      mass(71) = 57.933278_r64
      abundance(71) = 0.28_r64
      element(72) = "Ga"
      mass(72) = 68.925581_r64
      abundance(72) = 60.1_r64
      element(73) = "Ga"
      mass(73) = 70.924701_r64
      abundance(73) = 39.9_r64
      element(74) = "Gd"
      mass(74) = 151.919803_r64
      abundance(74) = 0.2_r64
      element(75) = "Gd"
      mass(75) = 153.920876_r64
      abundance(75) = 2.18_r64
      element(76) = "Gd"
      mass(76) = 154.822629_r64
      abundance(76) = 14.8_r64
      element(77) = "Gd"
      mass(77) = 155.92213_r64
      abundance(77) = 20.47_r64
      element(78) = "Gd"
      mass(78) = 156.923967_r64
      abundance(78) = 15.65_r64
      element(79) = "Gd"
      mass(79) = 157.924111_r64
      abundance(79) = 24.84_r64
      element(80) = "Gd"
      mass(80) = 159.927061_r64
      abundance(80) = 21.86_r64
      element(81) = "Ge"
      mass(81) = 69.92425_r64
      abundance(81) = 20.5_r64
      element(82) = "Ge"
      mass(82) = 71.92208_r64
      abundance(82) = 27.4_r64
      element(83) = "Ge"
      mass(83) = 72.923464_r64
      abundance(83) = 7.8_r64
      element(84) = "Ge"
      mass(84) = 73.921179_r64
      abundance(84) = 36.5_r64
      element(85) = "Ge"
      mass(85) = 75.921403_r64
      abundance(85) = 7.8_r64
      element(86) = "H"
      mass(86) = 1.007825_r64
      abundance(86) = 99.99_r64
      element(87) = "H"
      mass(87) = 2.014102_r64
      abundance(87) = 0.015_r64
      element(88) = "He"
      mass(88) = 3.016029_r64
      abundance(88) = 0.0001_r64
      element(89) = "He"
      mass(89) = 4.002603_r64
      abundance(89) = 100.0_r64
      element(90) = "Hf"
      mass(90) = 173.940065_r64
      abundance(90) = 0.16_r64
      element(91) = "Hf"
      mass(91) = 175.94142_r64
      abundance(91) = 5.2_r64
      element(92) = "Hf"
      mass(92) = 176.943233_r64
      abundance(92) = 18.6_r64
      element(93) = "Hf"
      mass(93) = 177.94371_r64
      abundance(93) = 27.1_r64
      element(94) = "Hf"
      mass(94) = 178.945827_r64
      abundance(94) = 13.74_r64
      element(95) = "Hf"
      mass(95) = 179.946561_r64
      abundance(95) = 35.2_r64
      element(96) = "Hg"
      mass(96) = 195.965812_r64
      abundance(96) = 0.15_r64
      element(97) = "Hg"
      mass(97) = 197.96676_r64
      abundance(97) = 10.1_r64
      element(98) = "Hg"
      mass(98) = 198.968269_r64
      abundance(98) = 17.0_r64
      element(99) = "Hg"
      mass(99) = 199.968316_r64
      abundance(99) = 23.1_r64
      element(100) = "Hg"
      mass(100) = 200.970293_r64
      abundance(100) = 13.2_r64
      element(101) = "Hg"
      mass(101) = 201.970632_r64
      abundance(101) = 29.65_r64
      element(102) = "Hg"
      mass(102) = 203.973481_r64
      abundance(102) = 6.8_r64
      element(103) = "Ho"
      mass(103) = 164.930332_r64
      abundance(103) = 100.0_r64
      element(104) = "I"
      mass(104) = 126.904477_r64
      abundance(104) = 100.0_r64
      element(105) = "In"
      mass(105) = 112.904056_r64
      abundance(105) = 4.3_r64
      element(106) = "In"
      mass(106) = 114.903875_r64
      abundance(106) = 95.7_r64
      element(107) = "Ir"
      mass(107) = 190.960603_r64
      abundance(107) = 37.3_r64
      element(108) = "Ir"
      mass(108) = 192.962942_r64
      abundance(108) = 62.7_r64
      element(109) = "K"
      mass(109) = 38.963708_r64
      abundance(109) = 93.2_r64
      element(110) = "K"
      mass(110) = 39.963999_r64
      abundance(110) = 0.012_r64
      element(111) = "K"
      mass(111) = 40.961825_r64
      abundance(111) = 6.73_r64
      element(112) = "Kr"
      mass(112) = 77.920397_r64
      abundance(112) = 0.35_r64
      element(113) = "Kr"
      mass(113) = 79.916375_r64
      abundance(113) = 2.25_r64
      element(114) = "Kr"
      mass(114) = 81.913483_r64
      abundance(114) = 11.6_r64
      element(115) = "Kr"
      mass(115) = 82.914134_r64
      abundance(115) = 11.5_r64
      element(116) = "Kr"
      mass(116) = 83.911506_r64
      abundance(116) = 57.0_r64
      element(117) = "Kr"
      mass(117) = 85.910614_r64
      abundance(117) = 17.3_r64
      element(118) = "La"
      mass(118) = 137.907114_r64
      abundance(118) = 0.09_r64
      element(119) = "La"
      mass(119) = 138.906355_r64
      abundance(119) = 99.91_r64
      element(120) = "Li"
      mass(120) = 6.015123_r64
      abundance(120) = 7.42_r64
      element(121) = "Li"
      mass(121) = 7.016005_r64
      abundance(121) = 92.58_r64
      element(122) = "Lu"
      mass(122) = 174.940785_r64
      abundance(122) = 97.4_r64
      element(123) = "Lu"
      mass(123) = 175.942694_r64
      abundance(123) = 2.6_r64
      element(124) = "Mg"
      mass(124) = 23.985045_r64
      abundance(124) = 78.9_r64
      element(125) = "Mg"
      mass(125) = 24.985839_r64
      abundance(125) = 10.0_r64
      element(126) = "Mg"
      mass(126) = 25.982595_r64
      abundance(126) = 11.1_r64
      element(127) = "Mn"
      mass(127) = 54.938046_r64
      abundance(127) = 100.0_r64
      element(128) = "Mo"
      mass(128) = 91.906809_r64
      abundance(128) = 14.84_r64
      element(129) = "Mo"
      mass(129) = 93.905086_r64
      abundance(129) = 9.25_r64
      element(130) = "Mo"
      mass(130) = 94.905838_r64
      abundance(130) = 15.92_r64
      element(131) = "Mo"
      mass(131) = 95.904676_r64
      abundance(131) = 16.68_r64
      element(132) = "Mo"
      mass(132) = 96.906018_r64
      abundance(132) = 9.55_r64
      element(133) = "Mo"
      mass(133) = 97.905405_r64
      abundance(133) = 24.13_r64
      element(134) = "Mo"
      mass(134) = 99.907473_r64
      abundance(134) = 9.63_r64
      element(135) = "N"
      mass(135) = 14.003074_r64
      abundance(135) = 99.63_r64
      element(136) = "N"
      mass(136) = 15.000109_r64
      abundance(136) = 0.37_r64
      element(137) = "Na"
      mass(137) = 22.98977_r64
      abundance(137) = 100.0_r64
      element(138) = "Nb"
      mass(138) = 92.906378_r64
      abundance(138) = 100.0_r64
      element(139) = "Nd"
      mass(139) = 141.907731_r64
      abundance(139) = 27.13_r64
      element(140) = "Nd"
      mass(140) = 142.909823_r64
      abundance(140) = 12.18_r64
      element(141) = "Nd"
      mass(141) = 143.910096_r64
      abundance(141) = 23.8_r64
      element(142) = "Nd"
      mass(142) = 144.912582_r64
      abundance(142) = 8.3_r64
      element(143) = "Nd"
      mass(143) = 145.913126_r64
      abundance(143) = 17.19_r64
      element(144) = "Nd"
      mass(144) = 147.916901_r64
      abundance(144) = 5.76_r64
      element(145) = "Nd"
      mass(145) = 149.9209_r64
      abundance(145) = 5.64_r64
      element(146) = "Ne"
      mass(146) = 19.992439_r64
      abundance(146) = 90.6_r64
      element(147) = "Ne"
      mass(147) = 20.993845_r64
      abundance(147) = 0.26_r64
      element(148) = "Ne"
      mass(148) = 21.991384_r64
      abundance(148) = 9.2_r64
      element(149) = "Ni"
      mass(149) = 57.935347_r64
      abundance(149) = 68.27_r64
      element(150) = "Ni"
      mass(150) = 59.930789_r64
      abundance(150) = 26.1_r64
      element(151) = "Ni"
      mass(151) = 60.931059_r64
      abundance(151) = 1.13_r64
      element(152) = "Ni"
      mass(152) = 61.928346_r64
      abundance(152) = 3.59_r64
      element(153) = "Ni"
      mass(153) = 63.927968_r64
      abundance(153) = 0.91_r64
      element(154) = "O"
      mass(154) = 15.994915_r64
      abundance(154) = 99.76_r64
      element(155) = "O"
      mass(155) = 16.999131_r64
      abundance(155) = 0.038_r64
      element(156) = "O"
      mass(156) = 17.999159_r64
      abundance(156) = 0.2_r64
      element(157) = "Os"
      mass(157) = 183.952514_r64
      abundance(157) = 0.02_r64
      element(158) = "Os"
      mass(158) = 185.953852_r64
      abundance(158) = 1.58_r64
      element(159) = "Os"
      mass(159) = 186.955762_r64
      abundance(159) = 1.6_r64
      element(160) = "Os"
      mass(160) = 187.95585_r64
      abundance(160) = 13.3_r64
      element(161) = "Os"
      mass(161) = 188.958156_r64
      abundance(161) = 16.1_r64
      element(162) = "Os"
      mass(162) = 189.958455_r64
      abundance(162) = 26.4_r64
      element(163) = "Os"
      mass(163) = 191.961487_r64
      abundance(163) = 41.0_r64
      element(164) = "P"
      mass(164) = 30.973763_r64
      abundance(164) = 100.0_r64
      element(165) = "Pb"
      mass(165) = 203.973037_r64
      abundance(165) = 1.4_r64
      element(166) = "Pb"
      mass(166) = 205.974455_r64
      abundance(166) = 24.1_r64
      element(167) = "Pb"
      mass(167) = 206.975885_r64
      abundance(167) = 22.1_r64
      element(168) = "Pb"
      mass(168) = 207.976641_r64
      abundance(168) = 52.4_r64
      element(169) = "Pd"
      mass(169) = 101.905609_r64
      abundance(169) = 1.02_r64
      element(170) = "Pd"
      mass(170) = 103.904026_r64
      abundance(170) = 11.14_r64
      element(171) = "Pd"
      mass(171) = 104.905075_r64
      abundance(171) = 22.33_r64
      element(172) = "Pd"
      mass(172) = 105.903475_r64
      abundance(172) = 27.33_r64
      element(173) = "Pd"
      mass(173) = 107.903894_r64
      abundance(173) = 26.46_r64
      element(174) = "Pd"
      mass(174) = 109.905169_r64
      abundance(174) = 11.72_r64
      element(175) = "Pr"
      mass(175) = 140.907657_r64
      abundance(175) = 100.0_r64
      element(176) = "Pt"
      mass(176) = 189.959937_r64
      abundance(176) = 0.01_r64
      element(177) = "Pt"
      mass(177) = 191.961049_r64
      abundance(177) = 0.79_r64
      element(178) = "Pt"
      mass(178) = 193.962679_r64
      abundance(178) = 32.9_r64
      element(179) = "Pt"
      mass(179) = 194.964785_r64
      abundance(179) = 33.8_r64
      element(180) = "Pt"
      mass(180) = 195.964947_r64
      abundance(180) = 25.3_r64
      element(181) = "Pt"
      mass(181) = 197.967879_r64
      abundance(181) = 7.2_r64
      element(182) = "Rb"
      mass(182) = 84.9118_r64
      abundance(182) = 72.17_r64
      element(183) = "Rb"
      mass(183) = 86.909184_r64
      abundance(183) = 27.84_r64
      element(184) = "Re"
      mass(184) = 184.952977_r64
      abundance(184) = 37.4_r64
      element(185) = "Re"
      mass(185) = 186.955765_r64
      abundance(185) = 62.6_r64
      element(186) = "Rh"
      mass(186) = 102.905503_r64
      abundance(186) = 100.0_r64
      element(187) = "Ru"
      mass(187) = 95.907596_r64
      abundance(187) = 5.52_r64
      element(188) = "Ru"
      mass(188) = 97.905287_r64
      abundance(188) = 1.88_r64
      element(189) = "Ru"
      mass(189) = 98.905937_r64
      abundance(189) = 12.7_r64
      element(190) = "Ru"
      mass(190) = 99.904218_r64
      abundance(190) = 12.6_r64
      element(191) = "Ru"
      mass(191) = 100.905581_r64
      abundance(191) = 17.0_r64
      element(192) = "Ru"
      mass(192) = 101.904348_r64
      abundance(192) = 31.6_r64
      element(193) = "Ru"
      mass(193) = 103.905422_r64
      abundance(193) = 18.7_r64
      element(194) = "S"
      mass(194) = 31.972072_r64
      abundance(194) = 95.02_r64
      element(195) = "S"
      mass(195) = 32.971459_r64
      abundance(195) = 0.75_r64
      element(196) = "S"
      mass(196) = 33.967868_r64
      abundance(196) = 4.21_r64
      element(197) = "S"
      mass(197) = 35.967079_r64
      abundance(197) = 0.02_r64
      element(198) = "Sb"
      mass(198) = 120.903824_r64
      abundance(198) = 57.3_r64
      element(199) = "Sb"
      mass(199) = 122.904222_r64
      abundance(199) = 42.7_r64
      element(200) = "Sc"
      mass(200) = 44.955914_r64
      abundance(200) = 100.0_r64
      element(201) = "Se"
      mass(201) = 73.922477_r64
      abundance(201) = 0.9_r64
      element(202) = "Se"
      mass(202) = 75.919207_r64
      abundance(202) = 9.0_r64
      element(203) = "Se"
      mass(203) = 76.919908_r64
      abundance(203) = 7.6_r64
      element(204) = "Se"
      mass(204) = 77.917304_r64
      abundance(204) = 23.5_r64
      element(205) = "Se"
      mass(205) = 79.916521_r64
      abundance(205) = 49.6_r64
      element(206) = "Se"
      mass(206) = 81.916709_r64
      abundance(206) = 9.4_r64
      element(207) = "Si"
      mass(207) = 27.976928_r64
      abundance(207) = 92.23_r64
      element(208) = "Si"
      mass(208) = 28.976496_r64
      abundance(208) = 4.67_r64
      element(209) = "Si"
      mass(209) = 29.973772_r64
      abundance(209) = 3.1_r64
      element(210) = "Sm"
      mass(210) = 143.912009_r64
      abundance(210) = 3.1_r64
      element(211) = "Sm"
      mass(211) = 146.914907_r64
      abundance(211) = 15.0_r64
      element(212) = "Sm"
      mass(212) = 147.914832_r64
      abundance(212) = 11.3_r64
      element(213) = "Sm"
      mass(213) = 148.917193_r64
      abundance(213) = 13.8_r64
      element(214) = "Sm"
      mass(214) = 149.917285_r64
      abundance(214) = 7.4_r64
      element(215) = "Sm"
      mass(215) = 151.919741_r64
      abundance(215) = 26.7_r64
      element(216) = "Sm"
      mass(216) = 153.922218_r64
      abundance(216) = 22.7_r64
      element(217) = "Sn"
      mass(217) = 111.904826_r64
      abundance(217) = 0.97_r64
      element(218) = "Sn"
      mass(218) = 113.902784_r64
      abundance(218) = 0.65_r64
      element(219) = "Sn"
      mass(219) = 114.903348_r64
      abundance(219) = 0.36_r64
      element(220) = "Sn"
      mass(220) = 115.901744_r64
      abundance(220) = 14.7_r64
      element(221) = "Sn"
      mass(221) = 116.902954_r64
      abundance(221) = 7.7_r64
      element(222) = "Sn"
      mass(222) = 117.901607_r64
      abundance(222) = 24.3_r64
      element(223) = "Sn"
      mass(223) = 118.90331_r64
      abundance(223) = 8.6_r64
      element(224) = "Sn"
      mass(224) = 119.902199_r64
      abundance(224) = 32.4_r64
      element(225) = "Sn"
      mass(225) = 121.90344_r64
      abundance(225) = 4.6_r64
      element(226) = "Sn"
      mass(226) = 123.905271_r64
      abundance(226) = 5.6_r64
      element(227) = "Sr"
      mass(227) = 83.913428_r64
      abundance(227) = 0.56_r64
      element(228) = "Sr"
      mass(228) = 85.909273_r64
      abundance(228) = 9.86_r64
      element(229) = "Sr"
      mass(229) = 86.908902_r64
      abundance(229) = 7.0_r64
      element(230) = "Sr"
      mass(230) = 87.905625_r64
      abundance(230) = 82.58_r64
      element(231) = "Ta"
      mass(231) = 179.947489_r64
      abundance(231) = 0.012_r64
      element(232) = "Ta"
      mass(232) = 180.948014_r64
      abundance(232) = 99.99_r64
      element(233) = "Tb"
      mass(233) = 158.92535_r64
      abundance(233) = 100.0_r64
      element(234) = "Te"
      mass(234) = 119.904021_r64
      abundance(234) = 0.096_r64
      element(235) = "Te"
      mass(235) = 121.903055_r64
      abundance(235) = 2.6_r64
      element(236) = "Te"
      mass(236) = 122.904278_r64
      abundance(236) = 0.91_r64
      element(237) = "Te"
      mass(237) = 123.902825_r64
      abundance(237) = 4.82_r64
      element(238) = "Te"
      mass(238) = 124.904435_r64
      abundance(238) = 7.14_r64
      element(239) = "Te"
      mass(239) = 125.90331_r64
      abundance(239) = 18.95_r64
      element(240) = "Te"
      mass(240) = 127.904464_r64
      abundance(240) = 31.69_r64
      element(241) = "Te"
      mass(241) = 129.906229_r64
      abundance(241) = 33.8_r64
      element(242) = "Th"
      mass(242) = 232.038054_r64
      abundance(242) = 100.0_r64
      element(243) = "Ti"
      mass(243) = 45.952633_r64
      abundance(243) = 8.0_r64
      element(244) = "Ti"
      mass(244) = 46.951765_r64
      abundance(244) = 7.3_r64
      element(245) = "Ti"
      mass(245) = 47.947947_r64
      abundance(245) = 73.8_r64
      element(246) = "Ti"
      mass(246) = 48.947871_r64
      abundance(246) = 5.5_r64
      element(247) = "Ti"
      mass(247) = 49.944786_r64
      abundance(247) = 5.4_r64
      element(248) = "Tl"
      mass(248) = 202.972336_r64
      abundance(248) = 29.52_r64
      element(249) = "Tl"
      mass(249) = 204.97441_r64
      abundance(249) = 70.48_r64
      element(250) = "Tm"
      mass(250) = 168.934225_r64
      abundance(250) = 100.0_r64
      element(251) = "U"
      mass(251) = 234.040947_r64
      abundance(251) = 0.006_r64
      element(252) = "U"
      mass(252) = 235.043925_r64
      abundance(252) = 0.72_r64
      element(253) = "U"
      mass(253) = 238.050786_r64
      abundance(253) = 99.27_r64
      element(254) = "V"
      mass(254) = 49.947161_r64
      abundance(254) = 0.25_r64
      element(255) = "V"
      mass(255) = 50.943963_r64
      abundance(255) = 99.75_r64
      element(256) = "W"
      mass(256) = 179.946727_r64
      abundance(256) = 0.13_r64
      element(257) = "W"
      mass(257) = 181.948225_r64
      abundance(257) = 26.3_r64
      element(258) = "W"
      mass(258) = 182.950245_r64
      abundance(258) = 14.3_r64
      element(259) = "W"
      mass(259) = 183.950953_r64
      abundance(259) = 30.67_r64
      element(260) = "W"
      mass(260) = 185.954377_r64
      abundance(260) = 28.6_r64
      element(261) = "Xe"
      mass(261) = 123.905894_r64
      abundance(261) = 0.1_r64
      element(262) = "Xe"
      mass(262) = 125.904281_r64
      abundance(262) = 0.09_r64
      element(263) = "Xe"
      mass(263) = 127.903531_r64
      abundance(263) = 1.91_r64
      element(264) = "Xe"
      mass(264) = 128.90478_r64
      abundance(264) = 26.4_r64
      element(265) = "Xe"
      mass(265) = 129.90351_r64
      abundance(265) = 4.1_r64
      element(266) = "Xe"
      mass(266) = 130.905076_r64
      abundance(266) = 21.2_r64
      element(267) = "Xe"
      mass(267) = 131.904148_r64
      abundance(267) = 26.9_r64
      element(268) = "Xe"
      mass(268) = 133.905395_r64
      abundance(268) = 10.4_r64
      element(269) = "Xe"
      mass(269) = 135.907219_r64
      abundance(269) = 8.9_r64
      element(270) = "Y"
      mass(270) = 88.905856_r64
      abundance(270) = 100.0_r64
      element(271) = "Yb"
      mass(271) = 167.933908_r64
      abundance(271) = 0.13_r64
      element(272) = "Yb"
      mass(272) = 169.934774_r64
      abundance(272) = 3.05_r64
      element(273) = "Yb"
      mass(273) = 170.936338_r64
      abundance(273) = 14.3_r64
      element(274) = "Yb"
      mass(274) = 171.936393_r64
      abundance(274) = 21.9_r64
      element(275) = "Yb"
      mass(275) = 172.938222_r64
      abundance(275) = 16.12_r64
      element(276) = "Yb"
      mass(276) = 173.938873_r64
      abundance(276) = 31.8_r64
      element(277) = "Yb"
      mass(277) = 175.942576_r64
      abundance(277) = 12.7_r64
      element(278) = "Zn"
      mass(278) = 63.929145_r64
      abundance(278) = 48.6_r64
      element(279) = "Zn"
      mass(279) = 65.926035_r64
      abundance(279) = 27.9_r64
      element(280) = "Zn"
      mass(280) = 66.927129_r64
      abundance(280) = 4.1_r64
      element(281) = "Zn"
      mass(281) = 67.924846_r64
      abundance(281) = 18.8_r64
      element(282) = "Zn"
      mass(282) = 69.925325_r64
      abundance(282) = 0.6_r64
      element(283) = "Zr"
      mass(283) = 89.904708_r64
      abundance(283) = 51.45_r64
      element(284) = "Zr"
      mass(284) = 90.905644_r64
      abundance(284) = 11.27_r64
      element(285) = "Zr"
      mass(285) = 91.905039_r64
      abundance(285) = 17.17_r64
      element(286) = "Zr"
      mass(286) = 93.906319_r64
      abundance(286) = 17.33_r64
      element(287) = "Zr"
      mass(287) = 95.908272_r64
      abundance(287) = 2.78_r64
   end subroutine create_old_periodic_table
end program test_periodictable
